{{ 'component-custom-faq.css' | asset_url | stylesheet_tag }}
{{ 'component-contact-faq.js' | asset_url | script_tag }}

{% assign first_category = '' %}
{% for i in (1..3) %}
  {% assign setting_id = 'category_' | append: i %}
  {% assign category_label = section.settings[setting_id] %}
  {% if first_category == '' and category_label != blank %}
    {% assign first_category = category_label %}
  {% endif %}
{% endfor %}

<section
  class="custom-faq custom-faq--contact section-padding--lg-bottom full-width"
  id="contact-faq-{{ section.id }}"
  data-contact-faq
  {% if first_category != blank %}
    data-faq-initial="{{ first_category | handle }}"
  {% endif %}
>
  <div class="container-xl g-4">
    <div class="custom-faq__header">
      {% if section.settings.heading != blank %}
        <h2 class="custom-faq__heading heading-style-h3">{{ section.settings.heading }}</h2>
      {% endif %}
      <div class="custom-faq__filters" role="tablist" aria-label="{{ 'faq.categories_label' | t }}">
        {% for i in (1..3) %}
          {% assign setting_id = 'category_' | append: i %}
          {% assign category_label = section.settings[setting_id] %}
          {% if category_label != blank %}
            {% assign category_handle = category_label | handle %}
            <button
              type="button"
              class="custom-faq__filter{% if category_label == first_category %} is-active{% endif %} heading-style-h6 m-0"
              data-faq-filter="{{ category_handle }}"
              aria-pressed="{% if category_label == first_category %}true{% else %}false{% endif %}"
            >
              {{ category_label }}
            </button>
          {% endif %}
        {% endfor %}
      </div>
    </div>

    <div class="custom-faq__accordion">
      <div class="accordion accordion-flush" id="FaqAccordion-{{ section.id }}">
        {% for block in section.blocks %}
          {% assign item_id = 'FaqItem-' | append: section.id | append: '-' | append: block.id %}
          {% assign collapse_id = 'FaqCollapse-' | append: section.id | append: '-' | append: block.id %}
          {% assign index_number = forloop.index | prepend: '0' %}
          {% assign category_handle = block.settings.category | handle %}
          <div
            class="accordion-item custom-faq__item"
            data-faq-category="{{ category_handle }}"
            {{ block.shopify_attributes }}
          >
            <h3 class="accordion-header" id="{{ item_id }}">
              <button
                class="accordion-button collapsed custom-faq__button"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#{{ collapse_id }}"
                aria-expanded="false"
                aria-controls="{{ collapse_id }}"
              >
                <span class="custom-faq__index">{{ index_number }}</span>
                <span class="custom-faq__question heading-style-h5">{{ block.settings.question }}</span>
                <span class="custom-faq__icon" aria-hidden="true">
                  <svg viewBox="0 0 24 24" focusable="false" aria-hidden="true">
                    <path
                      d="M12 5v14M5 12h14"
                      stroke="currentColor"
                      stroke-width="2"
                      stroke-linecap="square"
                    />
                  </svg>
                </span>
              </button>
            </h3>
            <div
              id="{{ collapse_id }}"
              class="accordion-collapse collapse"
              aria-labelledby="{{ item_id }}"
              data-bs-parent="#FaqAccordion-{{ section.id }}"
            >
              <div class="accordion-body custom-faq__answer">
                {{ block.settings.answer }}
              </div>
            </div>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Contact FAQ",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "FAQs"
    },
    {
      "type": "text",
      "id": "category_1",
      "label": "Category 1",
      "default": "Logistics"
    },
    {
      "type": "text",
      "id": "category_2",
      "label": "Category 2",
      "default": "Hardware"
    },
    {
      "type": "text",
      "id": "category_3",
      "label": "Category 3",
      "default": "Standards"
    }
  ],
  "blocks": [
    {
      "type": "item",
      "name": "FAQ item",
      "settings": [
        {
          "type": "text",
          "id": "category",
          "label": "Category",
          "default": "Logistics",
          "info": "Match one of the category labels."
        },
        {
          "type": "text",
          "id": "question",
          "label": "Question",
          "default": "What makes this product special?"
        },
        {
          "type": "richtext",
          "id": "answer",
          "label": "Answer",
          "default": "<p>Add your answer here.</p>"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Contact FAQ"
    }
  ]
}
{% endschema %}
