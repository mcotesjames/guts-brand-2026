{{ 'component-custom-header.css' | asset_url | stylesheet_tag }}
<script src="{{ 'component-custom-header.js' | asset_url }}" defer></script>

<header
  class="custom-header{% if section.settings.logo_image_dark != blank %} custom-header--has-dark-logo{% endif %}"
  data-custom-header
>
  <div class="custom-header__inner">
    <nav class="custom-header__nav" aria-label="{{ 'general.navigation_main' | t }}">
      <ul class="custom-header__menu">
        {% for link in section.settings.menu.links %}
          {% if link.links != blank %}
            <li class="custom-header__item dropdown">
              <button
                class="custom-header__link dropdown-toggle"
                type="button"
                id="HeaderDropdown-{{ section.id }}-{{ forloop.index }}"
                aria-expanded="false"
              >
                <span class="custom-header__link-text">{{ link.title }}</span>
                <span class="custom-header__dropdown-icon" aria-hidden="true">
                  {{ 'icon-dropdown.svg' | inline_asset_content }}
                </span>
              </button>
              <ul class="dropdown-menu" aria-labelledby="HeaderDropdown-{{ section.id }}-{{ forloop.index }}">
                {% for child_link in link.links %}
                  <li>
                    <a class="dropdown-item" href="{{ child_link.url }}">{{ child_link.title }}</a>
                  </li>
                {% endfor %}
              </ul>
            </li>
          {% else %}
            <li class="custom-header__item">
              <a class="custom-header__link" href="{{ link.url }}">
                <span class="custom-header__link-text">{{ link.title }}</span>
              </a>
            </li>
          {% endif %}
        {% endfor %}
      </ul>
    </nav>

    <div class="custom-header__logo">
      <a href="{{ routes.root_url }}" class="custom-header__logo-link" aria-label="{{ shop.name }}">
        {% if section.settings.logo_image != blank %}
          {%- assign logo_width = section.settings.logo_width | default: 160 -%}
          {{ section.settings.logo_image | image_url: width: logo_width | image_tag: alt: shop.name, loading: 'lazy', class: 'custom-header__logo-image custom-header__logo-image--light' }}
          {% if section.settings.logo_image_dark != blank %}
            {{ section.settings.logo_image_dark | image_url: width: logo_width | image_tag: alt: shop.name, loading: 'lazy', class: 'custom-header__logo-image custom-header__logo-image--dark' }}
          {% endif %}
        {% else %}
          <span class="custom-header__logo-text">{{ shop.name }}</span>
        {% endif %}
      </a>
    </div>

    <div class="custom-header__actions">
      {% if customer %}
        <a class="custom-header__b2b" href="/account">
          <span class="custom-header__b2b-icon custom-header__b2b-profile-icon" aria-hidden="true">
            {{ 'icon-account-black.svg' | inline_asset_content }}
          </span>
          Profile
        </a>
      {% elsif section.settings.b2b_label != blank %}
        <a class="custom-header__b2b" href="{{ section.settings.b2b_url | default: '#' }}">
          {% if section.settings.b2b_icon != blank %}
            {{ section.settings.b2b_icon | image_url: width: 32 | image_tag: alt: '', loading: 'lazy', class: 'custom-header__b2b-icon' }}
          {% endif %}
          {{ section.settings.b2b_label }}
        </a>
      {% endif %}

      {% if section.settings.show_search %}
        <button
          class="custom-header__icon-button"
          type="button"
          data-bs-toggle="collapse"
          data-bs-target="#HeaderSearch-{{ section.id }}"
          aria-expanded="false"
          aria-controls="HeaderSearch-{{ section.id }}"
        >
          <span class="visually-hidden">{{ 'search.submit' | t }}</span>
          <span class="custom-header__icon custom-header__icon--light">
            {{ 'icon-search.svg' | inline_asset_content }}
          </span>
          <span class="custom-header__icon custom-header__icon--dark">
            {{ 'icon-search-black.svg' | inline_asset_content }}
          </span>
        </button>
      {% endif %}
      {% if section.settings.show_cart %}
        <button
          class="custom-header__icon-button"
          type="button"
          aria-label="{{ 'cart.title' | t }}"
          data-cart-drawer-trigger
        >
          <span class="custom-header__icon custom-header__icon--light">
            {{ 'icon-cart.svg' | inline_asset_content }}
          </span>
          <span class="custom-header__icon custom-header__icon--dark">
            {{ 'icon-cart-black.svg' | inline_asset_content }}
          </span>
          <span
            class="custom-header__cart-count{% if cart.item_count == 0 %} is-hidden{% endif %}"
            data-cart-count
          >
            {{ cart.item_count }}
          </span>
        </button>
      {% endif %}
      {% if localization.available_languages.size > 1 %}
        {% assign header_locale_form_id = 'HeaderLocaleForm-' | append: section.id %}
        {% form 'localization', class: 'custom-header__locale', id: header_locale_form_id %}
          {% for language in localization.available_languages %}
            <button
              class="custom-header__locale-link{% if language.iso_code == localization.language.iso_code %} is-active{% endif %}"
              type="submit"
              name="language_code"
              value="{{ language.iso_code }}"
              {% if language.iso_code == localization.language.iso_code %}aria-current="true"{% endif %}
            >
              {{ language.iso_code | upcase }}
            </button>
            {% unless forloop.last %}
              <span class="custom-header__locale-separator" aria-hidden="true">|</span>
            {% endunless %}
          {% endfor %}
        {% endform %}
      {% endif %}
      
    </div>
    <button
      class="custom-header__burger"
      type="button"
      aria-label="{{ 'general.open_menu' | t }}"
      data-bs-toggle="offcanvas"
      data-bs-target="#MobileMenu-{{ section.id }}"
      aria-controls="MobileMenu-{{ section.id }}"
    >
      <span class="custom-header__burger-icon" aria-hidden="true">
        <span class="custom-header__burger-line"></span>
        <span class="custom-header__burger-line"></span>
        <span class="custom-header__burger-line"></span>
      </span>
      <span class="custom-header__burger-label custom-header__burger-label--open">{{ 'general.menu' | t }}</span>
      <span class="custom-header__burger-label custom-header__burger-label--close">{{ 'general.close' | t }}</span>
    </button>
  </div>

  {% if section.settings.show_search %}
    <div class="custom-header__search collapse" id="HeaderSearch-{{ section.id }}">
      <form class="custom-header__search-form" action="{{ routes.search_url }}" method="get" role="search">
        <div class="custom-input custom-input--search">
          <label class="custom-input__label" for="HeaderSearchInput-{{ section.id }}">
            {{ section.settings.search_placeholder }}
          </label>
          <input
            class="custom-input__field"
            id="HeaderSearchInput-{{ section.id }}"
            type="search"
            name="q"
          >
        </div>
        <button class="custom-button custom-button--secondary" type="submit">{{ 'search.submit' | t }}</button>
      </form>
    </div>
  {% endif %}

  <div
    class="custom-header__offcanvas offcanvas offcanvas-end"
    tabindex="-1"
    id="MobileMenu-{{ section.id }}"
    aria-labelledby="MobileMenuLabel-{{ section.id }}"
    data-custom-header-offcanvas
  >
    <div class="custom-header__offcanvas-header offcanvas-header">
      <a class="custom-header__offcanvas-logo" id="MobileMenuLabel-{{ section.id }}" href="{{ routes.root_url }}" aria-label="{{ shop.name }}">
        {% if section.settings.logo_image_dark != blank %}
          {%- assign logo_width = section.settings.logo_width | default: 160 -%}
          {{ section.settings.logo_image_dark | image_url: width: logo_width | image_tag: alt: shop.name, loading: 'lazy' }}
        {% elsif section.settings.logo_image != blank %}
          {%- assign logo_width = section.settings.logo_width | default: 160 -%}
          {{ section.settings.logo_image | image_url: width: logo_width | image_tag: alt: shop.name, loading: 'lazy' }}
        {% else %}
          {{ shop.name }}
        {% endif %}
      </a>
      <button class="custom-header__offcanvas-close" type="button" data-bs-dismiss="offcanvas" aria-label="{{ 'general.close' | t }}">
        <span aria-hidden="true">Ã—</span>
      </button>
    </div>

    <div class="custom-header__offcanvas-meta">
      {% if localization.available_languages.size > 1 %}
        {% assign mobile_locale_form_id = 'MobileLocaleForm-' | append: section.id %}
        {% form 'localization', class: 'custom-header__offcanvas-locale', id: mobile_locale_form_id %}
          {% for language in localization.available_languages %}
            <button
              class="custom-header__locale-link{% if language.iso_code == localization.language.iso_code %} is-active{% endif %}"
              type="submit"
              name="language_code"
              value="{{ language.iso_code }}"
              {% if language.iso_code == localization.language.iso_code %}aria-current="true"{% endif %}
            >
              {{ language.iso_code | upcase }}
            </button>
            {% unless forloop.last %}
              <span class="custom-header__locale-separator" aria-hidden="true">|</span>
            {% endunless %}
          {% endfor %}
        {% endform %}
      {% endif %}
      {% if section.settings.show_cart %}
        <button class="custom-header__offcanvas-cart" type="button" aria-label="{{ 'cart.title' | t }}" data-cart-drawer-trigger>
          {{ 'icon-cart-black.svg' | inline_asset_content }}
        </button>
      {% endif %}
    </div>

    <div class="custom-header__offcanvas-body offcanvas-body">
      <nav class="custom-header__offcanvas-nav" aria-label="{{ 'general.navigation_mobile' | t }}">
        <ul class="custom-header__offcanvas-menu">
          {% for link in section.settings.menu.links %}
            {% assign collapse_id = 'MobileMenuCollapse-' | append: section.id | append: '-' | append: forloop.index %}
            <li class="custom-header__offcanvas-item">
              {% if link.links != blank %}
                <button
                  class="custom-header__offcanvas-link custom-header__offcanvas-toggle"
                  type="button"
                  data-bs-toggle="collapse"
                  data-bs-target="#{{ collapse_id }}"
                  aria-expanded="false"
                  aria-controls="{{ collapse_id }}"
                >
                  {{ link.title }}
                  <span class="custom-header__offcanvas-caret" aria-hidden="true">
                    {{ 'icon-dropdown.svg' | inline_asset_content }}
                  </span>
                </button>
                <div class="collapse custom-header__offcanvas-submenu" id="{{ collapse_id }}">
                  <ul>
                    {% for child_link in link.links %}
                      <li>
                        <a class="custom-header__offcanvas-sublink" href="{{ child_link.url }}">
                          {{ child_link.title }}
                        </a>
                      </li>
                    {% endfor %}
                  </ul>
                </div>
              {% else %}
                <a class="custom-header__offcanvas-link" href="{{ link.url }}">{{ link.title }}</a>
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </nav>

      {% if section.settings.show_search %}
        <form class="custom-header__offcanvas-search" action="{{ routes.search_url }}" method="get" role="search">
          <div class="custom-input custom-input--search">
            <label class="custom-input__label" for="MobileSearchInput-{{ section.id }}">
              {{ section.settings.search_placeholder }}
            </label>
            <input
              class="custom-input__field"
              id="MobileSearchInput-{{ section.id }}"
              type="search"
              name="q"
              style="--custom-input-icon: url('{{ 'icon-input-search.svg' | asset_url }}');"
            >
            <button class="custom-input__icon-button" type="submit" aria-label="{{ 'search.submit' | t }}"></button>
          </div>
        </form>
      {% endif %}

      {% if customer %}
        <a class="custom-header__offcanvas-b2b custom-button custom-button--primary" href="/account">
          <span class="custom-header__b2b-icon custom-header__b2b-profile-icon" aria-hidden="true">
            {{ 'icon-account-black.svg' | inline_asset_content }}
          </span>
          Profile
        </a>
      {% elsif section.settings.b2b_label != blank %}
        <a class="custom-header__offcanvas-b2b custom-button custom-button--primary" href="{{ section.settings.b2b_url | default: '#' }}">
          {% if section.settings.b2b_icon != blank %}
            {{ section.settings.b2b_icon | image_url: width: 24 | image_tag: alt: '', loading: 'lazy', class: 'custom-header__offcanvas-b2b-icon' }}
          {% endif %}
          {{ section.settings.b2b_label }}
        </a>
      {% endif %}
    </div>
  </div>
</header>
